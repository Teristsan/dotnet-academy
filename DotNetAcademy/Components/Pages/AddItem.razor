@page "/additem"
@rendermode InteractiveServer
@using DotNetAcademy.Models
@using DotNetAcademy.Services.ItemService

<div class="d-flex flex-column justify-content-center align-items-center">
    <div class="d-flex justify-content-center align-items-center gap-4">
        <i class="bi bi-film"></i>
        <h3 class="m-0">
            Add New Item
        </h3>
    </div>
    <p>
        Create a new movie, series or anime entry
    </p>
    <!--Movie addition box-->
    <div class="border border-2 rounded p-3 mb-5" style="width: 50%">
        Entry Details

        <EditForm Model="Item" OnValidSubmit="Submit" FormName="AddItem">
            <div class="mb-2">
                <label class="d-flex flex-column justify-content-start">
                    <span class="mb-1">Type:</span>
                    <InputSelect @bind-Value="Item!.MediaType">
                        <option value="">
                            Select type
                        </option>
                        <option value="Movie">
                            Movie
                        </option>
                        <option value="Series">
                            Series
                        </option>
                        <option value="Anime">
                            Anime
                        </option>
                    </InputSelect>
                </label>
            </div>

            <div class="mb-2">
                <label class="d-flex flex-column justify-content-start">
                    <span class="mb-1">Title:</span>
                    <InputText @bind-Value="Item!.Title" />
                </label>
            </div>

            <div class="mb-2">
                <label class="d-block mb-2">
                    Main Poster Image
                </label>
                <div class="border border-2 rounded p-4 text-center">
                    <InputFile OnChange="HandlePosterUpload" accept="image/png,image/jpeg,image/gif" class="d-none" id="posterUpload" />
                    <label for="posterUpload" style="cursor: pointer;">
                        <div class="mb-2">
                            <i class="bi bi-upload" style="font-size: 2rem; color: #6c757d;"></i>
                        </div>
                        <div class="text-muted">
                            Click to upload image
                        </div>
                        <div class="text-muted small">
                            PNG or JPG up to 10MB
                        </div>
                    </label>
                </div>
            </div>

            <div class="mb-2">
                <label class="d-flex flex-column justify-content-start mb-2">
                    <span class="mb-1">Release Date:</span>
                    <InputDate @bind-Value="Item!.ReleaseDate" />
                </label>
            </div>

            <div class="mb-2">
                <label class="d-flex flex-column justify-content-start mb-2">
                    <span class="mb-1">Genre:</span>
                    <InputText @bind-Value="Item!.Genre" />
                </label>
            </div>

            <div class="mb-2">
                <label class="d-flex flex-column justify-content-start mb-2">
                    <span class="mb-1">Description:</span>
                    <InputTextArea @bind-Value="Item!.Description" />
                </label>
            </div>

            <div class="mb-2">
                <label class="d-flex flex-column justify-content-start mb-2">
                    <span class="mb-1">Rating:</span>
                    <InputNumber @bind-Value="Item!.Rating" />
                </label>
            </div>

            <div class="mb-4">
                <label class="d-block mb-2">
                    Gallery Images (Max 5)
                </label>
                <div class="border border-2 rounded p-4 text-center">
                    <InputFile OnChange="HandleGalleryUpload" multiple accept="image/png,image/jpeg" class="d-none" id="galleryUpload" />
                    <label for="galleryUpload" style="cursor: pointer;">
                        <div class="mb-2">
                            <i class="bi bi-upload" style="font-size: 2rem; color: #6c757d;"></i>
                        </div>
                        <div class="text-muted">
                            Add gallery images (@Item!.Images.Count/5)
                        </div>
                        <div class="text-muted small">
                            Click to upload multiple images
                        </div>
                    </label>
                </div>
            </div>

            <DataAnnotationsValidator />
            <ValidationSummary />
            
            <div class="d-flex justify-content-center gap-1">
                <button class="flex-grow-1 btn btn-dark" type="submit">Submit</button>
                <button class="flex-grow-1 btn btn-dark" @onclick="CancelItemAddition">Cancel</button>
            </div>
        </EditForm>
        
    </div>
</div>